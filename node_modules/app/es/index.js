'use strict';

/**
 * Module dependencies
 */

const koa = require('koa');
const hbs = require('koa-hbs');
const path = require('path');

/**
 * Local module dependencies
 */

var elastic = require('./model');

/**
 * Application
 */
var app = koa();

module.exports = conf => {
  elastic = elastic(conf);
  return app;
};

/**
 * Koa view
 */

app.use(hbs.middleware({
  viewPath: path.resolve(__dirname, './views')
}));
console.log(path.resolve(__dirname, './views'));

app.use(function*() {
  var result = yield elastic.home;
  yield this.render('index', {
    data: result
  });
});
